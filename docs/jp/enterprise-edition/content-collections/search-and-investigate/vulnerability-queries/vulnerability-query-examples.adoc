== 脆弱性クエリ例

[cols="49%a,51%a"]
|===
|*状態の意味*
|*RQL*

|ワークロード全体で脆弱なaアセットをすべて見つけます。
|\`vulnerability where asset.type = 'all'`

`vulnerability where asset.type IN ( 'Container Registry Image', 'Deployed Image', 'Host', 'IaC', 'Package', 'Serverless Function', 'VM Image')`

|コンピュートアセット内のすべての脆弱性を見つけます。
|\`vulnerability where source = 'compute'`

|重大度致命的および重大度高すべての脆弱性を見つけます。
|`vulnerability where severity IN ('Critical', 'High')`

|悪用可能な脆弱性を見つけます。
|`vulnerability where risk.factors IN('Exploitable')`

|インターネットからアクセス可能な脆弱なホストを見つけます。
|`vulnerability where risk.factors IN('Reachable from the internet')`

|CVSSスコアが10の脆弱性をすべて見つけます。
|`vulnerability where cvss.score = 10`

|いずれかのアセットが CVE-XXXX-XXXX に対して脆弱かどうかを特定します。
|\`vulnerability where cve.id='CVE-XXXX-XXXX'`

|ワークロード全体で脆弱なパッケージをすべて見つけます。
|`vulnerability where asset.type IN ('Package')`

|CVE-XXXX-XXXX に対して脆弱なパッケージを検索します。
|\`vulnerability where asset.type IN ('Package') AND cve.id = 'CVE-2010-3082'`

|CBDR (アプリライフサイクル) で脆弱なアセットを見つけます。
|`vulnerability where asset.lifecycle IN('Deploy','Build','Code','Run')`

|ランタイム環境で脆弱な資産を見つけます。
|`vulnerability where asset.lifecycle = 'Run'

|ディストリビューションバージョンの脆弱性を見つけます。
|\`vulnerability where version='0.6.45-1ubuntu1.3'`

|脆弱性の高いサーバーレス機能を見つけます。
|`vulnerability where asset.type IN ( 'aws-ec2-describe-images', 'azure-compute-image', 'gcloud-compute-image') AND with :(Vuln where SEVERITY >= HIGH)`

|===
