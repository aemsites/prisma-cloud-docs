== データの探索とカスタム ポリシーの作成

xref:build-modify-queries.adoc[クエリを作成し]た後、その結果を分析し、エンジニアリングエコシステム全体にわたるセキュリティ問題の詳細な分析を実行できます。クラウドセキュリティ環境を探索し、詳細なセキュリティ コンテキストを組み合わせて、組織が注力すべきリスクのある領域を見つけることができます。たとえば、最新の log5j 脆弱性の影響を受けるクラウド内の資産を特定し、環境内で特定された最新のインシデントを調査し、インシデントに寄与した可能性のあるリスク要因を調査したいとします。新しい複雑なクエリ言語を学ぶ必要がなく、ポイントアンドクリックでクラウド資産とセキュリティ データを迅速かつ簡単に探索できます。

image::search-and-investigate/explore-data-1.png[]
//image::search-and-investigate/investigate-example-query-results.png[]

*グラフ ビュー* に表示されるクエリ結果には、次のコンポーネントが含まれます。

* xref:nodes[ノード]:エンティティを含めることができるリポジトリのアセット。
* xref:edges[エッジ]:ノード間の接続。
* *Export*[エクスポート]:グラフデータを .png 画像または JSON ファイルとしてダウンロードします。
* *コントロール*:ズームしてリセットします。

[#nodes]
=== ノード

ノードの詳細を表示するには、グラフ上のノードを選択するか、ノードを右クリックして *[情報]*を選択します。*[詳細]* パネルが開き、ノードの詳細とそのノードの下にグループ化されたエンティティが表示されます。ノードのエッジと他のノードへの接続もグラフに表示されます。

*ノードエンティティ*

同じ種類のノードはグループ化され、1つのグループ ノードの下に表示されます。ノード内の数字は、そのノードがグループ ノードであることと、グループ内のエンティティの数を示します。すべてのエンティティ、エンティティの詳細を表示したり、グループからエンティティを抽出してグラフ上に個別に表示したりできます。

[cols="50%a,50%a"]
|===
|*ノード上のアクション*
|*手順*

|*グループノードのすべてのエンティティを表示*
|. グループノードの *詳細*パネルを開きます。
. グループノードをクリックし、*[展開されたノード] フィールド*でノードを選択します。ノードがグループ ノードの下に再グループ化され、*[折りたたまれたノード]* フィールドの下に表示されます。または
. グラフ上で抽出されたノードを右クリックし、*[折りたたみ]*を選択します。エンティティはグループ ノードに再グループ化されます。

|*グループノードからエンティティを抽出*
|. *[詳細]* パネルでエンティティをクリックします。
+
選択したエンティティが *[展開された*ノード] フィールドに移動するか、または
. グループノードを右クリックし、*[展開]*を選択します。
//add more info after *Expand*
+
[NOTE]
====
[詳細]パネルでエンティティをクリックすると、エンティティがノード グループから抽出され、グラフ上に個別のノードとして表示されます。
====

|*抽出されたエンティティの詳細を表示*
|. *[詳細]* パネルでエンティティをクリックするか、
. グラフ上のグループ ノードを右クリックして *[展開]*を選択し、抽出されたノードを右クリックして *[情報]*を選択します。

|*抽出されたノードを再グループ化*
|. グループノードの詳細パネルを開き、[グループノード]をクリックし、 *展開された*ノードフィールドでノードを選択します。ノードがグループ ノードの下に再グループ化され、*[折りたたまれたノード]* フィールドの下に表示されます。または
. グラフ上で抽出されたノードを右クリックし、*[折りたたみ]*を選択します。エンティティはグループ ノードに再グループ化されます。

|*抽出されたすべてのノードを再グループ化*
|グラフ上で抽出されたノードを右クリックし、*[すべて折りたたみ]*を選択します。抽出されたすべてのノードがグループ ノードに再グループ化されます。

|===

[#edges]
=== エッジ

エッジとは、ノード間の関係を表示する接続です。パス矢印は、送信元ノードとターゲットノード間の方向を示します。

[cols="50%a,50%a"]
|===
|*エッジ上のアクション*
|*手順*

|*ノードとエッジの関係を表示*
|ノードをクリックします。他のノードへのノードの接続が表示されます。関係の種類や方向など、関係の詳細が表示されます。

|*接続の詳細を表示*
|[接続]をクリックします。接続の*[詳細]*パネルが開き、接続によって接続されているソースノードとターゲットノード、および接続のタイプが表示されます。

|===


*グラフ*モードでは、ノードを選択してハイライトをプレビューできます。アセットの詳細を表示するには、*[詳細の表示]* を選択します。*[攻撃経路]*には、 特定のアセットに適用される攻撃経路が表示されます。*アラート*にはアラートの詳細が表示されます。

image::search-and-investigate/explore-data-2.png[]

グラフにはノードとエッジが表示されます。ただし、結果が多すぎて意味のあるアクションを実行できない場合もあります。検索を絞り込んで特定のニーズに応えるには、数回クリックするだけでクエリを絞り込み、コンテキストを追加できます。たとえば、必要に応じてアセットタイプを追加して範囲を広げたり、新しい発見を組み合わせに導入したり、クラウドアカウントなどの他のフィルターを追加して特定のチームやビジネスユニットに焦点を当てたりすることができます。

この場合、悪意のある人物がこれらの要素を利用して仮想通貨マイニング活動を行っているかどうかを調べたいと考えてみてください。_crypto_を検索し、その結果をクエリに追加するだけです。重大な脆弱性のあるアセットを特に見つけたい場合は、検索を再度実行する前に、対応するフィルターを簡単に追加できます。

検索結果実行すると、新しくレンダリングされたグラフが表示され、検索結果は多くのオプションの中から最も重要なものに絞り込まれ、集中しやすくなります。これにより、何が問題になる可能性があるかだけでなく、環境内で何が問題になったかを確認することもできます。最後に、脆弱性グループを展開して特定のCVEを表示し、ここから直接修復アクションをトリガーすることもできます。

次に、*[保存] > [新しい保存済み検索として保存]*を選択し、クエリのタイトルと説明を更新して、これを新しいクエリとして *保存*します 。デフォルトでは、クエリのタイトルは *複製:<クエリ名>*になります。

image::search-and-investigate/explore-data-3.png[]

//*View Mode*--graph vs. table details?

=== カスタムポリシーを作成

ほとんどのエンタープライズには特定の要件があり、組織のニーズに合わせたカスタムポリシーを作成したいと考えています。アセットの属性とセキュリティ コンテキストに基づいてアセットを検索した後、リスクをより適切に修復し、クラウド環境を保護するために、リスクのあるアセットのカスタム ポリシーを作成できます。

上記の例では、検索結果を特定のクエリに絞り込むと、非常にユニークで貴重な攻撃パスが見つかりました。ここで、この組み合わせによってアプリケーションが危険にさらされた場合にセキュリティチームに自動的に警告するセキュリティガードレールがあることを確認する必要があります。

* *[保存] > [ポリシーとして保存]*を選択します。Prisma Cloudは、ポリシーに変換する前に検索を保存します。
+
image::search-and-investigate/save-policy-1.png[]
* *[ポリシーの保存と作成]*を選択して、ポリシー名、説明 (オプション)、重大度、およびラベル (オプション) を追加または更新します。
* *[クエリの作成]*で、保存された検索を使用するか、結果を更新して新しい検索を開始します。
+
image::search-and-investigate/save-policy-2.png[]
* *推奨修復手順*を追加し (オプション)、*[送信]* を選択して、保存されたクエリに基づいて新しい攻撃経路ポリシーを作成します。

Prisma Cloudが提供する強力なグラフ視覚化により、カスタムポリシーを簡単に設定して、セキュリティ体制をさらに改善できるようになりました。