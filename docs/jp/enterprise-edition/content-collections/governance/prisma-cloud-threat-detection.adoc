[#id8b916ac6-ae8f-4edf-be45-60193351c187]
== Prisma Cloudの脅威検出

Prisma Cloudは、クラウドセキュリティ体制管理（CSPM）モジュールとクラウドワークロード保護プラットフォーム（CWPP）全体で脅威検出を可能にし、マルチハイブリッドクラウド環境、ホスト、コンテナー、サーバーレス機能全体でセキュリティリスクを防止および検出できます。

CSPMは、インシデントとリスクの2つのカテゴリのポリシーをサポートしています。インシデントは脅威検出機能を提供するポリシーのグループであり、2種類の異常ポリシーが含まれています。機械学習またはAutoFocusを利用するユーザーエンティティ動作分析（UEBA）およびネットワークの異常。リスクカテゴリは、リソースクエリ言語（RQL）を使用する*設定*ポリシーに対応します。

異常ポリシーでは、監査やネットワークフローログなどのさまざまなソースからデータが収集され、機械学習、統計モデリング、グラフ分析などの高度なデータ分析技術を使用して処理され、既知と未知の両方の脅威を検出します。RQLベースのポリシーでは、ユーザーまたはネットワークアクティビティに関連するイベントは、特定の値を持つJSONフィールドなど、特定の条件と一致するよう分析されます。

//Need to clarify the protions about RQL network and
CWPPモジュールの脅威検出は、商用およびオープンソースの両方のソースから集約された脅威データのコレクションで構成され、Prisma Cloudインテリジェンスストリームを介して配信されます。その後、この脅威データは、*脆弱性*や*ランタイム*などのComputeのさまざまな機能セット全体で消費されます。

* xref:#id3ce4176e-b19c-4878-9cc8-1b967f333dcb[CSPMでの脅威の検出]

* xref:#ida1f54b12-64cc-4483-a61e-e3f708e7815c[CWPPでの脅威の検出]

[#id3ce4176e-b19c-4878-9cc8-1b967f333dcb]
=== CSPMでの脅威の検出
Prisma CloudのCSPMモジュールの脅威検出機能の概要。

Prisma Cloudは、アカウントハイジャックの試み、バックドアアクティビティ、ネットワークデータの流出、異常なプロトコル、DDoSアクティビティの検出など、無数のユースケースに関するポリシーを提供します。脅威が検出されると、問題を管理者に通知するアラートが生成されるため、管理者は問題を迅速に修復できます。さらに、これらのポリシーのいくつかは、クラウド資産を保護するためのロードマップとして機能するMITRE ATT&CK®エンタープライズIaaSマトリックスにマッピングされています。

* *異常ポリシー*：
+
** *ユーザーエンティティと行動分析（UEBA）*- 不明な場所からログオンしているユーザー、離れた場所からの連続したログイン試行、または作成されるコンピュートリソースの異常な数など、逸脱したユーザーアクティビティを識別するための一連の異常ポリシー。すべてのUEBAポリシーを表示するには、*Policies（ポリシー）*の*Anormaly（異常）*に対して*Policy Type（ポリシーの種類）*のフィルタを適用し、検索フィールドに「*ueba*」と入力し、*UEBA*の*ポリシーサブタイプ*の結果を表示します。

** *ネットワーク異常ポリシー*— 機械学習を使用してネットワークログを継続的に監視し、https://docs.paloaltonetworks.com/autofocus/autofocus-admin/get-started-with-autofocus.html[AutoFocus]に対してIPを照合する異常ポリシーのセットです。ボットネット、ランサムウェア、ワーム攻撃など、さまざまな脅威を検出するためのネットワークアノマリポリシーがあります。Prisma Cloudは現在、40 以上のネットワーク ポリシーをサポートしています-*Policies（ポリシー）*の*Anormaly（異常）*で*Policy Type（ポリシーの種類）*フィルタを適用し、検索フィールドに*Network（ネットワーク）*と入力して、*Network（ネットワーク）*の*ポリシーサブタイプ*の結果を表示することで、すべてのポリシーを表示できます。

** *異常設定のカスタマイズ*-異常設定を使用して、アノマリポリシーに対してアラートが生成される基準を制御できます。異常設定を変更して、モデルトレーニングのしきい値の変更、アラートの処理のカスタマイズ、信頼されたリソースからの警告を抑制する信頼済みリストの追加を行うことができます。
+
*** *Alert disposition（アラートの処理）*—アラートの通知を受け取る場合の設定を指定する方法（*Conservative（少なめ）*、*Moderate（中）*、または*Agressive（多め）*）は、問題の重大度である*低*、*中*、*高*に基づいています。*Conservative（少なめ）*は重大度の高いアラート、*Moderate（中）*はの重大度が高いまたは中程度のアラート、*Agressive（多め）*は一般的に高、中、低重大度のアラートが生成されます。
+
[NOTE]
====
重大度を決定するための基準は、ポリシーごとに異なります。
====


*** *Anomaly training model thresholds（異常トレーニングモデルしきい値）*—UEBAおよびネットワーク異常の異常検出のモデルをトレーニングするためのさまざまなしきい値を定義する方法。*Training Model Threshold（トレーニングモデルのしきい値）*は、*Low（低）*、*中（Medium）*または*高（High）*に設定できます。これらのしきい値は、モデルのトレーニングに使用されるボリューム（100件のユーザーイベントの最小値など）とデータの期間（30日など）を決定するために使用されます。異常ポリシーしきい値のカスタマイズの詳細については、xref:../administration/define-prisma-cloud-enterprise-settings.adoc#anomaly-thresholds[異常ポリシーしきい値の設定]を参照してください。
+
[NOTE]
====
しきい値は、ポリシーごとに異なります。
====

*** *Anomaly trusted list（異常信頼リスト）*—アラートを生成しない特定のリソースを抑制する方法。例えば、侵入テストの実行に使用しているIPアドレスがある場合、それらのIPアドレスを信頼されたリストに追加して、アラートを抑制できます。異常信頼リストの作成の詳細については、xref:../alerts/suppress-alerts-for-prisma-cloud-anomaly-policies.adoc[Prisma Cloudアノマリポリシーのアラートを抑制する]を参照してください。

* *リソースクエリ言語*（RQL）ポリシー：
+
** *監査イベント*:ポリシー違反の可能性がある環境で監査イベントを監視する、RQLベースのポリシーのセット。監査ポリシーを作成することで、クラウド環境を危険にさらす可能性のあるルートアクティビティや設定変更など、機密性の高いイベントにフラグを付けることができます。利用可能なすべての監査イベントポリシーを表示するには、*Policy Type（ポリシーの種類）*にフィルタを適用し、*Audit Event（監査イベント）*を選択します。カスタム監査イベントポリシーの作成方法については、「xref:create-a-policy.adoc#create-an-audit-event-policy[ネットワークまたは監査イベントポリシーの作成]」を参照してください。

** *ネットワークイベント*—環境内のネットワークアクティビティを監視するRQLベースのポリシーのセット。利用可能なネットワークポリシーをすべて表示するには、*Policy Type（ポリシーの種類）*にフィルタを適用し、*Network（ネットワーク）*を選択します。カスタムネットワークイベントポリシーを作成する方法については、「xref:create-a-policy.adoc#create-an-audit-event-policy[ネットワークまたは監査イベントポリシーの作成]」を参照してください。

** *サードパーティ統合*で動作するカスタムポリシー- Amazon GuardDutyやAWS Inspectorなどのサードパーティサービスと統合して、脅威検出機能を強化するカスタムRQLベースのポリシーを作成できます。さらに、既存のRQLベースのポリシーを複製し、特定のクラウドセキュリティニーズに合わせて変更を加える機能もあります。カスタムポリシーの作成の詳細については、xref:create-a-policy.adoc[Prisma Cloudでのカスタムポリシーの作成]を参照してください。

* *MITRE ATT&CK® Enterprise IaaS MatrixへのPrisma Cloudマッピング*- MITRE ATT&CKマトリックスは、悪意のある人物が攻撃に利用する戦術、テクニック、手順（TTP）の知識ベースです。このサブセットであるIaaSマトリックスは、クラウドベースの戦術とテクニックをカバーしています。Prisma Cloudには、IaaSマトリックスにマッピングされる構成ポリシーと異常ポリシーがあり、クラウドのセキュリティを継続的に監視して検出と初期アクセスを監視し、影響を与え、流出する目的を達成します。これにより、セキュリティチームは、クラウド環境全体でさまざまな攻撃の脅威を自動的に検出できます。*Anormaly（異常）*の*Policy Type（ポリシーの種類）*フィルタを適用して、IaaSマトリックスのこれらの目標にマッピングするポリシーを表示し、*MITRE ATT&CK v8.2*のような結果を表示するIaaSマトリックスのバージョンを含む*コンプライアンス標準*フィルタを表示します。その後、Prisma Cloud検索ボックスに*検出*や*影響*など、アノマリポリシーの表示目的を入力します。

[#ida1f54b12-64cc-4483-a61e-e3f708e7815c]
=== CWPPでの脅威の検出
Prisma CloudのCWPPモジュールの脅威検出機能の概要。

Prisma Cloud CWPP モジュールは、Prisma Cloudインテリジェンスストリームを介して、Prisma Cloudの高度な脅威検出（ATD）を介して脅威検出をサポートします。ATDは、商業脅威フィード、オープンソース脅威フィード、IP評判リスト、Prisma Cloud Labs、共通脆弱性識別子（CCV）、およびユーザーが提供するデータからデータを収集する、コンピューティングの脅威データの主なソースです。Prisma Cloudインテリジェンスストリームは、ATDのデータを使用して脅威フィードをリアルタイムで配信し、その後、脆弱性、ランタイム、Webアプリケーション、APIセキュリティ（WAAS）などの複数の機能で利用され、計算ワークロード全体でさまざまな脅威検出機能を提供します。

//I assume “compute workloads” is the right terminology to use
//I’m not sure what keyword I should use to describe the CWPP platform. Should it be “Prisma Cloud Compute?”
* *脆弱性*—さまざまなプロバイダ、パッケージ、および画像からのCVE情報はPrisma Cloudインテリジェンスストリームから取得され、その上に追加情報と脆弱性スキャンのリスクスコアが追加されます。脅威フィードで取得する情報の種類によって、エクスプロイトが存在するかどうか、攻撃の複雑さの種類、および環境リスクが明らかになります。リスクスコアは、CCVからComputeが持つデータと環境要因から計算され、*Runtime Security（ランタイムセキュリティ）> Monitor(監視) > Vulnerabilities（脆弱性）*で確認できます。詳細については、「xref:../runtime-security/vulnerability-management/vulnerability-explorer.adoc[脆弱性エクスプローラー]」を参照してください。

* *ランタイム*—Prisma Cloudインテリジェンスストリームから疑わしいマルウェアが存在することが知られている悪意のあるIPアドレス、ドメイン、またはファイルへの接続から脅威データを取り込み、それを使用して異常な動作を検出します。*インシデントエクスプローラ*（*ランタイムセキュリティ > 監視 > ランタイム > インシデントエクスプローラ*）では、24時間ごとにインシデントタイプごとに1つのアラートが発生し、同じインシデントタイプに対する後続のアラートは抑制されます。また、*インシデントエクスプローラ*でライブフォレンジックを表示することで、リソースのランタイム情報を分析できます。ランタイムはまた、Palo Alto Networksマルウェア検出エンジンであるWildFire（*Runtime Security（ランタイムセキュリティ）> Monitor(監視) > System（システム）> WildFire*）と統合し、マルウェア検出機能を強化する既知と未知の脅威の両方のマルウェアを識別します。Compute（コンピュート）でのランタイム防御の詳細については、xref:../runtime-security/runtime-defense/runtime-defense-containers.adoc[コンテナのランタイム防御]を参照してください。

* *WAAS*—WebアプリケーションにHTTP要求を行う場合、そのリソースでWAASが有効になっている場合、Compute（コンピュート）はそれらの要求を分析します。リソースに対して計算行動分析が行われ、その意図を判断するために要求が分析されます。このデータは、複数のサイトにまたがるスクリプト（XSS）やSQLインジェクションなど、Compute（コンピュート）が評価するさまざまな脅威に亘って分析され、アラートは*Runtime Security（ランタイムセキュリティ）> Monitor(監視) >Events（イベント）*で、*Containers（コンテナ）*、*Hosts（ホスト）*、または*Serverless（サーバーレス）*に対して生成されます。コンピュートでの WAAS の動作の概要についてはxref:../runtime-security/waas/waas.adoc[WebアプリケーションおよびAPIセキュリティ（WAAS）]を参照してください。

//I assume computational behavioral analysis is the right term



