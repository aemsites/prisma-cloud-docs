[#id0d4b823b-0b56-4562-9014-a03a0b12e67f]
== Prisma Cloudへのリソースリストの追加

タグを使用して、クラウド環境にデプロイされているリソースを識別します。

リソースリストは、特定のタグまたはラベルが割り当てられているリソースを識別する方法です。リソースリストには、タグまたはワークロードのタイプを含めることができます。

* xref:#id334bfb12-8cbe-460e-8698-fc4994e61b69[タグによるクラウドリソースの識別]
* xref:#idd0ab9614-5daa-40b4-91cd-9bee6f70f2e6[コンピュートリソースのリソースリストの作成]
* xref:#id814aa2ea-b823-4727-93ea-010ccf9edd44[Azureリソースグループのリソースリストの作成]


[.task]
[#id334bfb12-8cbe-460e-8698-fc4994e61b69]
=== タグによるクラウドリソースの識別

タグのリソースリストは、テンプレート展開ワークフローの一部としてリソースに割り当てられたタグ、または手動で追加されたタグを参照できます。割り当てられたタグに基づいてリソースを識別するリストを作成した後、このリストを使用してPrisma Cloudプラグインを使用したIaCテンプレートのスキャンを行うには、リソースリストをPrisma Cloudロールとビルド時チェックのアラートルールに添付する必要があります。

[.procedure]
. *Settings（設定）> Resource Lists（リソースリスト）*を選択します。

. *リソースリストの追加 > タグ*。

. *Resource List Name（リソースリスト名）*を入力します。
+
オプションで説明を入力できます。

. タグを識別するための*Key（キー）*と*Value（値）*を指定します。
+
リソースリストには、最大20のキーと値のペアを追加できます。リソースリストで複数のタグを指定する場合、IaCテンプレートには、アラートルールのポリシーに対してスキャンされるリソースリストで定義されたタグが少なくとも1つ含まれている必要があります。タグはuserinput:[tag_key:tag_value]の形式で指定する必要があります。

. リストを*保存*します。

. リソースリストをPrisma Cloudロールに添付します。
+
xref:create-prisma-cloud-roles.adoc[Prisma Cloudロールを作成する]と、選択したロールに関連付けられているユーザーがスキャン結果を確認できます。


[.task]
[#idd0ab9614-5daa-40b4-91cd-9bee6f70f2e6]
=== コンピュートリソースのリソースリストの作成

Prisma Cloud のコンピュートアクセスグループ リソースリストを使用すると、次のことが可能になります。

* *Runtime Security(ランタイムセキュリティ)*で表示されるデータへのアクセスを読み取り専用ロールに制限します。
+
ロールにアクセス可能なホスト、コンテナ、イメージ、サーバーレス機能など、ワークロードまたはリソースのタイプのスコープを定義し、そのロールをPrisma Cloud読み取り専用ロールに割り当てることができます。ユーザーがデータを表示するには、アカウントグループまたはオンプレミスプロバイダにデータを割り当てる必要があります。リストの一致条件に含めるワークロードはスコープ内にあり、ロールに割り当てられているユーザーがアクセスできます。
+
Compute（コンピュート）では、このリソースリストは割り当てられたコレクションと呼ばれ、アカウント内のすべてのリソースへのアクセスを許可する代わりに、指定されたリソースのセットへのきめ細かいアクセスを可能にする方法です。

* xref:../governance/workload-protection-policies.adoc[ワークロード保護ポリシー]を含むアラート ルールを使用して、アラートをトリガーする *Compute（コンピュート）* ワークロード (ホストとコンテナー イメージ) をターゲットにします。


[.procedure]
. *Settings（設定）> Resource Lists（リソースリスト）*を選択します。

. *Add Resource List(リソースリストの追加)> Compute Access Group(コンピュートアクセスグループ)*。

. *Resource List Name（リソースリスト名）*を入力します。
+
オプションで説明を入力できます。

. フィルタを指定して、各タイプのリソース内でアクセス可能な範囲を定義します。
+
デフォルトでは、コンテナ、イメージ、ホストなど、特定のタイプのすべてのオブジェクトに一致するように、各フィールドにワイルドカードが入力されます。個々のフィールドは、ANDロジックを使用して結合されます。文字列マッチングを使用して、フィールドの評価方法をカスタマイズできます。リソース名にワイルドカードを使用すると、ワイルドカードの位置に従ってリソース名が評価されます。文字列がワイルドカードで始まる場合は、string-starts-withとして評価されます。文字列がワイルドカードで終了する場合、string-ends-with;として評価されます。文字列がワイルドカードで開始および終了する場合、string-containsとして評価されます。
+
例として、Ubuntuの最新バージョンを使用するプロダクション名とイメージ名で始まるホスト名を照合し、コンテナ名またはラベルを無視するには、*Hosts（ホスト）*の場合はuserinput:[production{asterisk}]の値を入力し、*Images（イメージ）*の場合はuserinput:[{asterisk}/ubuntu:latest] と入力し、イメージ名の/library/ubuntu:latestやdocker.io/library/ubuntu:latestに一致させる必要があります。その他の例については、https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin-compute/configure/rule_ordering_pattern_matching.html[パターンマッチング]を参照してください。
+
image::administration/resource-list-cag.png[]

. リストを*保存*します。

. *Compute（コンピュート）*でこのリソースリストを表示します。
+
リソースリストは、コレクションのリストに自動的に追加されます。*Manage（管理）> Collections And Tags（コレクションとタグ）> Collections（コレクション）*を選択し、名前でリソースリストを検索します。コンピュートアクセスグループのリソースリストはコレクションのリストに含まれていますが、*Compute（コンピュート）*タブで編集したり、リソースにセキュリティチェックを適用するためのルールを追加または編集するときに使用したりすることはできません。

. リソース リストを添付します。
+
コンピュート アクセス グループ リソース リストを Prisma Cloud ロールまたはアラート ルールにアタッチできるようになりました。
+
.. xref:create-prisma-cloud-roles.adoc#id6d0b3093-c30c-41c4-8757-2efbdf7970c8[Prisma Cloud ロールを作成] し、リソース リストをロールに添付する場合は、ロールに少なくとも 1 つのアカウント グループが割り当てられていること、または *オンプレミス/その他のクラウドプロバイダー*からのデータへのアクセスが有効になっていることを確認します。

.. ユーザーにロールを割り当てて、リソースリストで定義したスコープの*Compute（コンピュート）*に関するデータをユーザーが確認できるようにします。


[.task]
[#id814aa2ea-b823-4727-93ea-010ccf9edd44]
=== Azureリソースグループのリソースリストの作成

Azureリソースグループのリソースリストを作成し、それをロールに割り当ててアクセスを制限します。次に、アラート、コンプライアンス、およびアセットインベントリダッシュボードでこれらをフィルタリングします。

Azureリソースグループのリソースリストを使用すると、関連付けられたデータを表示できるPrismaCloud上のロールを指定できます。これにより、データへのアクセスを制限でき、フィルタを使用してそのデータを拡大できるため、可視性が向上します。Azureリソースグループをフィルタ処理して、その中のデータのみを表示するコンプライアンス基準レポートを生成するか、アセットインベントリダッシュボードでフィルタを適用して、監視する1つ以上のAzureリソースグループデータを選択できます。Alerts Overview（アラートの概要）、Alerts Reports（アラートレポート）およびInvestigate（調査）ページでAzureリソースグループに基づいてフィルター処理することもできます。

Prisma Cloudカスタマーサポートに連絡して、Prisma CloudテナントでAzure Resource Groupリソースリストを有効にします。

[.procedure]
. *Settings（設定）> Resource Lists（リソースリスト）*を選択します。

. *Add Resource List(リソースリストの追加)> Azure Resource Group(Azureリソースグループ)*。
+
システム管理者のみがリソースグループを作成できます。

. リソースリストの詳細を入力します。
+
* *Name（名前）*-リソースリストの名前を入力します。
* *tt:[Description]（説明）*-リソースリストの目的を入力します。
* *Azure Resource Group(s)（Azureリソースグループ）*-ダイアログボックスをクリックして、リソースリストに追加するAzureリソースグループを選択します。

. *Submit（送信）* をクリックします。

. tt:[(任意)] リソースリストをPrisma Cloudロールに添付します。
+
Azureリソースグループリソースリストをロールに割り当てると、そのロールは、コンプライアンスダッシュボードとアセットインベントリダッシュボードのリソースリストにあるAzureリソースグループにアクセスできるようになります。切り替えるロールにリソースリストが割り当てられていない場合、対応するダッシュボードにリソースリストデータは表示されません。
+
これは現在、Azureリソースにのみ適用されます。AWS、GCP、およびAzureリソースにアクセスできる場合、リソースリストのフィルタリングはAzureリソースにのみ適用されますが、AWSおよびGCPデータには引き続きアクセスできます。

. リソースリストをフィルタリングして、コンプライアンスダッシュボードとアセットインベントリダッシュボードにデータを表示します。

.. コンプライアンスダッシュボードにフィルタを適用します。
+
* *Compliance（コンプライアンス）> Overview（概要）*を選択し、プラスアイコン(image:filter-plus-icon.png)をクリックして、フィルタメニュー項目を表示および追加します。
* ロールに関連付けられているリソースリストデータを表示するには、*Azure Resource Group（Azureリソースグループ）*を選択します。
+
image::administration/compliance-azure-resource-group-1.png[]

. アセットインベントリダッシュボードにフィルタを適用します。
+
* *Inventory（インベントリ）> Assets（アセット）*を選択し、プラスアイコンをクリックして、フィルタメニュー項目を表示および追加します。
* ロールに関連付けられているリソースリストデータを表示するには、*Azure Resource Group（Azureリソースグループ）*を選択します。
+
image::administration/asset-inventory-azure-resource-group-2.png[]
+
Asset Inventory（アセットインベントリ）ページに表示されるAzureリソースは、ロールに関連付けられているリソースリストに属しています。AWSやGCPなど、他のクラウドタイプに属するアカウントにアクセスできる場合、それらのリソースはフィルタリングされず、それらのクラウドタイプに関連付けられているすべてのデータが表示されます。

. *Investigate（調査）*ページでフィルタを適用します。
+
* *Investigate（調査）*を選択します。
* 検索バーに設定クエリを入力します。screen:[config from cloud.resource where azure.resource.group = ] リソースグループのリストが非常に長くなる可能性があるため、リソースグループは自動推奨されません。リソースグループを手動で入力する必要があります。
* 複数のリソースグループに基づいてフィルタリングすることもできます。screen:[config from cloud.resource where azure.resource.group IN (’resource-group1’) AND (’resource-group2’)]