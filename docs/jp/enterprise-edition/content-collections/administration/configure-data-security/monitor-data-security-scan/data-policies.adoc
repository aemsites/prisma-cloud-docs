[#data-policies]
== データポリシーを使用したデータ漏えいまたはマルウェアのスキャン

Prisma Cloudには、スキャンの開始に役立つデフォルトのデータポリシーが含まれています。これらのデータポリシーには、マルウェアを検出し、機密データの不注意または悪意のある露出を防ぐことができる事前定義済みデータプロファイルとデータパターンが含まれています。また、組織内のデータ漏洩を検出して防止するために、データパターンと近接キーワードを含むカスタムデータポリシーを作成することもできます。データポリシーを有効にすると、Prisma Cloudはマルウェアを検出し、データがどのように公開されているかを可視化します。アラートを生成する場合は、アラートルールを作成し、アラートを適用するデータポリシーを含める必要があります。

* xref:#idcd1a0523-2186-44cc-9cb3-201f9b057b39[Prisma Cloudへの新しいデータプロファイルの追加]
* xref:#idd48115a7-0b21-41d1-aaeb-da15099564e9[Prisma Cloudで新しいデータパターンを追加する]
* xref:#idaf1783dc-24f2-42e7-81db-519978a3f0b0[カスタムデータポリシーの作成]
* xref:#ida32d859b-724d-416f-9000-74fa6de13688[データポリシーのアラートの生成]


[.task]
[#idcd1a0523-2186-44cc-9cb3-201f9b057b39]
=== Prisma Cloudへの新しいデータプロファイルの追加

データプロファイルは、Prisma Cloudのデータパターンの集まりで、クラウドリソース内の機密データをスキャンするために使用することができます。Prisma Cloudには、事前定義済みデータプロファイルを使用する機能、またはカスタムデータプロファイルを作成するオプションが用意されています。カスタムデータプロファイルを使用すると、事前定義済みデータパターンとカスタムデータパターンを組み合わせて、コンテンツスキャンのユースケースに合わせることができます。

[.procedure]
. *Settings（設定） > Data（データ） > Data Profile（データプロファイル）*を選択します。

. *+Add New（新しく追加）*し、*Data Profile Name（データプロファイル名）*とオプションの*Data Profile Description（データプロファイルの説明）*を入力します。
//+
//image::administration/add-data-profile.png[]

. データパターンを選択します。
+
少なくとも1つの*データパターン*を選択し、コンテンツ照合のために以下のしきい値を変更します:

** *Match（一致）*—データプロファイルにデータパターンを含めるか除外するかを指定します。デフォルトは*Includes（次を含む）*です。

** *Occurrence（発生）*—*any（任意）*、*More than or equal to（次の値以上）*、*Less than or equal to（次の値以下）*、および*Between（範囲）*の条件ロジックをデータパターンに適用します。デフォルトは*More than or equal to（次の値以上）*です。

** *Min（最小）*—一致をトリガーする最小発生回数。

** *Max（最大）*—選択した発生タイプが*between（範囲内）*の場合にのみ適用されます。

** *Confidence（信頼性）*—コンテンツを識別し、低いまたは高い信頼度で評価するコンテンツ分析手法。
+
Low Confidence（低信頼度）—低信頼度の一致は、指定されたパターンのみを調べます。正規表現、機械学習、チェックサムなどの複数の手法を使用してコンテンツを識別します。
+
高信頼度 - 高信頼度の一致では、低信頼度の一致で使用されている手法に加えて、近接キーワード、一致の両側200文字を検索します。
//+
//image::administration/select-pattern-patterns.png[]

. *Next（次へ）*をクリックしてデータプロファイルを確認し、*保存*します。
//+
//image::administration/add-data-profile-summary.png[]
+
データプロファイルはデフォルトで*Enabled（有効）*になっており、データポリシーで使用できます。スキャンを無効にするには、アイコンを切り替えます。
//+
//image::administration/view-data-profile-in-table.png[]


[.task]
[#idd48115a7-0b21-41d1-aaeb-da15099564e9]
=== Prisma Cloudで新しいデータパターンを追加する

データパターンは、ファイルやオブジェクトをスキャンして機密性の高いコンテンツを探すために使用されるエンティティです。Prisma Cloudは、API認証情報、クライアントID、ヘルスケアプロバイダ、納税者番号など、600を超える事前定義済みデータパターンをサポートしています。データパターンは、リスクをスキャンしてデータを保護するために、データプロファイルとともに使用されます。また、カスタムパターンを作成した後、それらを複製して編集することもできます。事前定義済みデータパターンは削除または変更できません。

[.procedure]
. *Settings（設定）> Data（データ） > Data Patterns（データパターン）*を選択します。

. *+Add New（新規追加）*で新しいパターンを作成します。

. *データパターン名*を入力し、パターンの説明を入力します。

. *Regular Expressions（正規表現）*を追加します。
+
正規表現（regix）は、アセット内で検索するデータの一致基準です。基本的な表現またはテキストエントリにスコアを割り当てる加重エクスプレッションを追加できます。正規表現の後にセミコロンと-9999 ～ 9999の数字を追加することで、重みを割り当てることができます。ウェイトが割り当てられていない場合、デフォルトで「1」が追加されます。パターンマッチは、スコアのしきい値を超えると発生します。

. (tt:[任意]）一致の精度を向上させるには、*近接キーワード*を使用して、200文字以内に表示する必要のあるキーワードを指定します。
//+
//image::administration/create-a-data-pattern.png[]

. *OK*をクリックしてデータパターンを保存します。
//+
//image::administration/view-data-patterns-table.png[]


[.task]
[#idaf1783dc-24f2-42e7-81db-519978a3f0b0]
=== カスタムデータポリシーの作成

カスタムデータポリシーを作成する前に、まずアカウントをオンボードし、Data Securityを有効にする必要があります。

[.procedure]
. *Policies（ポリシー） > Add Policy（ポリシーを追加） > Data（データ）*を順に選択します 。
+
新しいポリシーのポリシー名、説明、重大度、およびラベルを入力します。

. *データプロファイル*を選択します。
+
財務情報、医療情報、知的財産、PII、カスタムデータプロファイルなど、事前定義済みデータプロファイルのいずれかを選択できます。

. File Exposure（ファイル公開）を選択します。
+
xref:exposure-evaluation.adoc[公開]は、プライベート、パブリック、条件付き (AWS のみ)、または外部 (Azure のみ) のいずれかにすることができます。

. 機密情報をスキャンする*ファイル拡張子*を選択します。
+
例：*txt*。Financial Information（財務情報）、Public（公開）、およびtxtを選択すると、公開されている.txtファイルに財務情報がある場合、ポリシーによってアラートが生成されます。拡張子の前にドットを使用しないでください。ドットを使用すると、エラーメッセージが表示されます。

. データポリシーを*保存*します。
//+
//image::administration/pcds-add-data-policy-1.png[]
+
これで、このカスタムポリシーをアラートルールに追加できます。


[.task]
[#ida32d859b-724d-416f-9000-74fa6de13688]
=== データポリシーのアラートの生成

アラートを生成するには、データポリシーをアラートルールに添付する必要があります。アラート ルールの詳細については、xref:../../../alerts/create-an-alert-rule-cloud-infrastructure.adoc[ランタイム チェックのアラートルールの作成]を参照してください。次のセクションでは、Prisma Cloud Data Securityでサポートされているポリシーと通知チャネルに焦点を当てます。

[.procedure]
. 新しいアラートルールを作成するか、既存のルールを編集します。
+
事前定義済みデータポリシーまたは任意のカスタムポリシーのリストから選択できます。使用可能なデータ ポリシーのリストをフィルタリングして表示するには、xref:../../../governance/manage-prisma-cloud-policies.adoc[Prisma Cloud ポリシーの管理]を参照してください。以下に例を示します。
+
* 公開されたヘルスケア情報を含むオブジェクト
* 知的財産を含むオブジェクトの公開
* 公開されている財務情報を含むオブジェクト
* 公開された PII データを含むオブジェクト
* 公開されているGDPRを含むオブジェクト（EUのみ）
* マルウェアを含むオブジェクト
//+
//image::administration/pcds-data-policies.png[]

. 通知チャネルを選択します。
+
Prisma Cloud Data Securityは、Amazon SQS、Splunk、およびウェブフックの統合のみをサポートします。xref:../../configure-external-integrations-on-prisma-cloud/configure-external-integrations-on-prisma-cloud.adoc[Prisma Cloudでの外部統合の設定]を参照してください。

. アラートルールを保存することを*確認します*。

. データポリシーのアラートとスキャン結果を表示します。

.. *Alerts（アラート） > Overview（概要）*を選択します。

... ポリシータイプでフィルタリング-データ。データポリシーに関連するすべてのアラートを表示します。

... アラートを選択して詳細を表示します。
+
* Object Name（オブジェクト名）を選択し、xref:object-explorer.adoc[オブジェクト情報]を表示します。
* Alert Rule(アラートルール）を選択すると、この特定のインスタンスを生成するアラートルールが表示されます。

.. *Dashboard（ダッシュボード） > Data（データ）*を選択します。
+
*Top Publicly Exposed Objects by Data Profile（プロファイル別の上位公開オブジェクト）*ウィジェットと*Object Data Profile Region（オブジェクトデータプロファイルリージョン）*マップでは、コンテンツがどのように公開されているかを確認できます。
